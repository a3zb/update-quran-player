<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Oussama - Quran Player</title>
    <link rel="icon" type="image/png" href="favicon.png">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#380056">
    <link rel="stylesheet" href="style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">
    <link
        href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Noto_Naskh_Arabic:wght@400;700&display=swap"
        rel="stylesheet">
    <style>
        @font-face {
            font-family: 'Uthmanic';
            src: url('https://fonts.gstatic.com/s/amiri/v26/J7afp9dbcD7yc6rCx6QP.woff2');
            /* Fallback link, or real font path */
        }
    </style>
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('sw.js')
                    .then(reg => console.log('Service Worker Registered'))
                    .catch(err => console.log('Service Worker Registration Failed', err));
            });
        }
    </script>
</head>

<body>
    <div class="video-background-container">
        <video id="backgroundVideo" autoplay loop muted playsinline>
        </video>
        <div class="video-overlay"></div>
    </div>

    <!-- Top Navigation Bar -->
    <div class="top-nav">
        <button id="menuBtn" class="menu-btn" title="القائمة"><i class="fas fa-bars"></i></button>
        <div class="logo">Oussama</div>
    </div>

    <!-- Side Menu / Drawer -->
    <div id="sideMenu" class="side-menu">
        <div class="side-menu-content">
            <button id="closeMenuBtn" class="close-menu">&times;</button>
            <div class="menu-header">
                <img src="favicon.png" alt="Logo" class="menu-logo">
                <h3>القائمة الرئيسية</h3>
            </div>
            <nav class="menu-nav">
                <a href="#" id="navHome" class="menu-item active"><i class="fas fa-home"></i> <span>الرئيسية
                        (الاستماع)</span></a>
                <a href="#" id="navReading" class="menu-item"><i class="fas fa-book-open"></i> <span>الورد اليومي
                        (قراءة)</span></a>
                <a href="#" id="navFavorites" class="menu-item"><i class="far fa-heart"></i> <span>المفضلة</span></a>
                <a href="#" id="navSettings" class="menu-item"><i class="fas fa-cog"></i> <span>الإعدادات</span></a>
            </nav>
            <div class="menu-footer">
                <p>اللهم اجعل القرآن ربيع قلوبنا</p>
            </div>
        </div>
    </div>



    <div id="homePage" class="page active">
        <header>
            <h1>Quran library </h1>


            <!-- Contact Content Section -->
            <div id="contactContent" class="contact-content">
                <div class="contact-content-inner">
                    <button class="close-contact">&times;</button>
                    <h2>تواصل معنا</h2>
                    <div class="contact-text">
                        <p>يمكنك التواصل معنا عبر منصات التواصل الاجتماعي:</p>
                        <div class="social-links">
                            <a href="https://t.me/pnqqy" target="_blank" class="social-link telegram">
                                <i class="fab fa-telegram"></i>
                                <span>Telegram</span>
                            </a>
                            <a href="https://wa.me/213775525723" target="_blank" class="social-link whatsapp">
                                <i class="fab fa-whatsapp"></i>
                                <span>WhatsApp</span>
                            </a>
                            <a href="mailto:info@quranapp.com" class="social-link email">
                                <i class="fas fa-envelope"></i>
                                <span>Email</span>
                            </a>
                            <a href="https://www.instagram.com/9g7.x" target="_blank" class="social-link instagram">
                                <i class="fab fa-instagram"></i>
                                <span>Instagram</span>
                            </a>
                            <a href="https://www.youtube.com/channel/UCl7sbdme2LGjwEam-11mvrw" target="_blank"
                                class="social-link youtube">
                                <i class="fab fa-youtube"></i>
                                <span>YouTube</span>
                            </a>
                            <a href="https://www.tiktok.com/@qx.pd.7x" target="_blank" class="social-link tiktok">
                                <i class="fab fa-tiktok"></i>
                                <span>TikTok</span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>


            <!-- Help Content Section -->
            <div id="helpContent" class="help-content">
                <div class="help-content-inner">
                    <button class="close-help">&times;</button>
                    <h2>كيفية استخدام الموقع</h2>
                    <div class="help-text">
                        <p>مرحبا بكم في موقعنا,موقعنا يوفر لكم استماع للقرآن الكريم وقرائته مع قرائ مختلفين</p>
                        <ul>
                            <li>ابحث عن القراء المفضلين لديك في شريط البحث</li>
                            <li>تتوفر عدة تلاوات وقرائ مختلفين </li>
                            <li>يمكنك البحث عن الآيات التي تحب</li>
                            <li>يمكنك إضافة السور المفضلة لديك و ايضا الآيات مفضلة </li>
                            <li>يمكنك تعيين مؤقت للنوم</li>
                            <li>يمكنك التحكم في الصوت</li>
                            <li>يمكنك مشاركة الموقع مع أصدقائك</li>
                            <li>يمكنك التواصل معنا عبر منصات التواصل الاجتماعي</li>
                            <li>لا تنسونا بدعائكم و دعاء لإخواننا في غزة</li>
                        </ul>
                    </div>
                </div>
            </div>
        </header>
        <main>
            <div class="search-container">
                <div class="search-input-group">
                    <input type="text" id="searchInput" class="search-input" placeholder="ابحث عن القران...">
                    <button id="searchBtn" class="search-btn" title="بحث"><i class="fas fa-search"></i></button>
                </div>
                <div class="search-options">
                    <label class="search-option">
                        <input type="radio" name="searchType" value="all" checked>
                        <span>الكل</span>
                    </label>
                    <label class="search-option">
                        <input type="radio" name="searchType" value="surah">
                        <span>السورة</span>
                    </label>
                    <label class="search-option">
                        <input type="radio" name="searchType" value="reader">
                        <span>القارئ</span>
                    </label>
                    <label class="search-option">
                        <input type="radio" name="searchType" value="verse">
                        <span>الآية</span>
                    </label>
                </div>
                <div class="search-options" id="playStartOptions" style="display: none;">
                    <span class="search-options-label">بداية التشغيل:</span>
                    <label class="search-option">
                        <input type="radio" name="playStart" value="verse" checked>
                        <span>من الآية</span>
                    </label>
                    <label class="search-option">
                        <input type="radio" name="playStart" value="beginning">
                        <span>بداية السورة</span>
                    </label>
                </div>
            </div>
            <div id="resumePrompt" class="resume-prompt" style="display: none;">
                <div class="resume-content">
                    <p id="resumeText">هل تريد الاستمرار من حيث توقفت؟</p>
                    <div class="resume-btns">
                        <button id="resumeYesBtn" class="resume-btn yes">نعم</button>
                        <button id="resumeNoBtn" class="resume-btn no">إلغاء</button>
                    </div>
                </div>
            </div>
            <ul id="songList" class="song-list">
                <li class="loading-songs">Listen Quran...</li>
            </ul>
            <!-- Dua al-Khatmah Button -->
            <button id="duaKhatmahBtn" class="dua-btn">
                <i class="fas fa-hands-praying"></i>
                <span>دعاء ختم القرآن الكريم</span>
            </button>
        </main>
    </div>

    <!-- Settings Page -->
    <div id="settingsPage" class="page">
        <header>
            <button id="backToHomeFromSettingsBtn" class="back-btn"><i class="fas fa-arrow-right"></i> عودة</button>
            <h1>الإعدادات</h1>
        </header>

        <div class="settings-container">
            <div class="settings-group">
                <h3>حول التطبيق</h3>
                <button id="btnShowHowTo" class="settings-btn">
                    <i class="fas fa-question-circle"></i>
                    <span>كيفية استخدام الموقع</span>
                </button>
                <button id="btnShowContact" class="settings-btn">
                    <i class="fas fa-envelope"></i>
                    <span>تواصل معنا</span>
                </button>
            </div>

            <div class="settings-group">
                <h3>تطبيق القرآن الكريم</h3>
                <p style="opacity: 0.7; font-size: 0.9rem; text-align: center;">إصدار 2.0 - جميع الحقوق محفوظة</p>
            </div>
        </div>
    </div>

    <div id="songDetailPage" class="page">
        <button id="backToHomeFromDetailBtn" class="back-btn"><i class="fas fa-arrow-right"></i> عودة</button>
        <div class="song-detail-container">
            <div class="song-detail-header">
                <img id="detailAlbumArt" src="https://placehold.co/200x200/3a3a4e/e0e0e0?text=Art" alt="Album Art"
                    class="detail-album-art">
                <div class="detail-info">
                    <h2 id="detailTrackTitle">عنوان السورة</h2>
                    <p id="detailTrackArtist">اسم القارئ</p>
                    <p id="detailTrackSecondArtist" class="second-artist"></p>
                    <p id="detailAlbumName">اسم المصدر</p>
                </div>
            </div>
            <div class="detail-controls">
                <button id="playFromDetailBtn" class="play-from-detail-btn"><i class="fas fa-play-circle"></i>
                    تشغيل</button>
                <div class="detail-input-container">
                    <i class="fas fa-microphone"></i>
                    <input type="range" id="detailVolumeSlider" class="detail-volume-slider" min="0" max="100" step="1"
                        value="50">
                    <span id="detailVolumeValue">50</span>
                </div>
            </div>
        </div>
    </div>

    <div id="playerPage" class="page">
        <div class="player-header-nav">
            <button id="backToHomeBtn" class="close-player-btn" title="إغلاق المشغل"><i
                    class="fas fa-xmark"></i></button>
        </div>

        <div class="music-player-container">
            <div class="music-player-box">
                <div class="player-header">
                    <img id="albumArt" src="https://placehold.co/100x100/3a3a4e/e0e0e0?text=Art" alt="Album Art"
                        class="album-art-player">
                    <div class="track-info-player">
                        <h2 id="playerTrackTitle">اسم السورة</h2>
                        <p id="playerTrackArtist">اسم القارئ</p>
                        <p id="playerTrackSecondArtist" class="second-artist"></p>
                    </div>
                </div>

                <div class="player-lyrics-header">
                    <h3>كلمات السورة</h3>
                    <div class="lyrics-font-controls">
                        <button id="decreaseLyricsFont" title="تصغير الخط"><i class="fas fa-minus"></i></button>
                        <span id="lyricsFontSizeValue">100%</span>
                        <button id="increaseLyricsFont" title="تكبير الخط"><i class="fas fa-plus"></i></button>
                    </div>
                </div>
                <div id="lyricsContainer" class="lyrics-container">
                    <p>الآيات تظهر هنا عند التشغيل...</p>
                </div>


                <div class="player-controls">
                    <div class="progress-section-player">
                        <div id="playerProgressBarContainer" class="progress-bar-container-player">
                            <div id="playerProgressBar" class="progress-bar-player"></div>
                        </div>
                        <div class="time-display-player">
                            <span id="playerCurrentTime">0:00</span>
                            <span id="playerTotalDuration">0:00</span>
                        </div>
                    </div>

                    <div class="main-controls-player">
                        <button id="playerShuffleBtn" class="control-btn-player secondary" title="تبديل عشوائي"><i
                                class="fas fa-shuffle"></i></button>
                        <button id="playerPrevBtn" class="control-btn-player" title="السابق"><i
                                class="fas fa-backward-step"></i></button>
                        <button id="playerSkipBackBtn" class="control-btn-player small-icon skip-btn"
                            title="رجوع 10 ثواني"><i class="fas fa-rotate-left"></i><span>10</span></button>
                        <button id="playerPlayPauseBtn" class="control-btn-player play-pause-player"
                            title="تشغيل/إيقاف"><i class="fas fa-play"></i></button>
                        <button id="playerSkipForwardBtn" class="control-btn-player small-icon skip-btn"
                            title="تقديم 10 ثواني"><i class="fas fa-rotate-right"></i><span>10</span></button>
                        <button id="playerNextBtn" class="control-btn-player" title="التالي"><i
                                class="fas fa-forward-step"></i></button>

                        <button id="playerRepeatBtn" class="control-btn-player secondary" title="تكرار"><i
                                class="fas fa-repeat"></i></button>
                    </div>

                    <div class="secondary-controls-player">
                        <div class="volume-control-player">
                            <button id="volumeBtn" class="control-btn-player small-icon" title="الصوت"><i
                                    class="fas fa-volume-up"></i></button>
                            <div id="volumePopover" class="volume-popover">
                                <input type="range" id="playerVolumeSlider" class="detail-volume-slider" min="0" max="1"
                                    step="0.01" value="0.8">
                            </div>
                        </div>
                        <div class="sleep-control-player">
                            <button id="sleepTimerBtn" class="control-btn-player small-icon" title="مؤقّت إيقاف"><i
                                    class="fas fa-moon"></i></button>
                            <div id="sleepTimerPopover" class="sleep-popover">
                                <div class="sleep-title">إيقاف بعد:</div>
                                <div class="sleep-grid">
                                    <button class="sleep-option" data-min="5">5 دقائق</button>
                                    <button class="sleep-option" data-min="10">10 دقائق</button>
                                    <button class="sleep-option" data-min="20">20 دقيقة</button>
                                </div>
                                <div class="sleep-custom">
                                    <input id="sleepCustomMinutes" type="number" min="1" max="600"
                                        placeholder="دقائق مخصّصة" aria-label="عدد الدقائق">
                                    <button id="sleepStartCustomBtn" class="sleep-option">بدء</button>
                                </div>
                                <button id="sleepCancelBtn" class="sleep-cancel" disabled>إلغاء المؤقّت</button>
                                <div id="sleepRemaining" class="sleep-remaining" style="display:none;"></div>
                            </div>
                        </div>
                        <button id="favoriteSurahBtn" class="control-btn-player small-icon" title="سورة مفضلة"><i
                                class="far fa-heart"></i></button>
                        <button id="addBookmarkBtn" class="control-btn-player small-icon" title="إضافة إشارة"><i
                                class="fas fa-bookmark"></i></button>
                        <button id="toggleBookmarksBtn" class="control-btn-player small-icon" title="إشاراتي"><i
                                class="fas fa-list"></i></button>
                        <button id="downloadSurahBtn" class="control-btn-player small-icon"
                            title="تحميل للاستماع بدون إنترنت">
                            <i class="fas fa-cloud-arrow-down"></i>
                        </button>
                    </div>
                </div>
                <!-- Bookmarks panel -->
                <div id="bookmarksPanel" class="bookmarks-panel" style="display:none;">
                    <div class="bookmarks-header">
                        <span>الإشارات</span>
                        <button id="closeBookmarksBtn" class="control-btn-player small-icon" title="إغلاق"><i
                                class="fas fa-xmark"></i></button>
                    </div>
                    <ul id="bookmarksList" class="bookmarks-list"></ul>
                </div>
                <p class="footer-credit">code by: @qx.pd </p>
            </div>
        </div>
    </div>

    <!-- Reading Mode Page (Daily Word Sanctuary) -->
    <div id="readingPage" class="page">
        <header class="reading-header">
            <button id="backToHomeFromReadingBtn" class="back-btn"><i class="fas fa-arrow-right"></i> عودة</button>
            <h2 id="readingSurahTitle">سورة ...</h2>
            <div class="reading-actions" style="display:flex; gap:10px;">
                <button id="khatmahSettingsBtn" class="action-btn" title="تخطيط الختمة"><i
                        class="fas fa-calendar-check"></i></button>
                <button id="listenFromReadingBtn" class="action-btn" title="استماع لهذه السورة"><i
                        class="fas fa-play"></i></button>
            </div>
        </header>

        <!-- Khatmah Planner Info -->
        <div id="khatmahPlanner" class="khatmah-planner-card" style="display: none;">
            <div class="planner-header">
                <h3><i class="fas fa-star"></i> خطة الختمة اليومية <span id="currentKhatmahDayBadge"
                        class="khatmah-day-badge">اليوم 1</span></h3>
                <div class="planner-meta" style="display:flex; align-items:center; gap:10px;">
                    <span id="khatmahStreak" class="streak-badge" title="سلسلة الإنجاز اليومي"><i
                            class="fas fa-fire"></i> 0 يوم</span>
                    <button id="closePlannerBtn" class="close-small">&times;</button>
                </div>
            </div>
            <div class="planner-body">
                <p id="khatmahGoalText">سوف تقرأ <span id="dailyVerseCount"
                        style="color:#a855f7; font-weight:bold;">...</span> آية يومياً لتختم في <span id="khatmahDays"
                        style="color:#a855f7; font-weight:bold;">...</span> يوم.</p>
                <div class="progress-container-mini">
                    <div id="dailyProgress" class="progress-bar-mini" style="width: 0%"></div>
                </div>
                <small id="dailyStatusText">أكملت 0 آيات من وردك اليومي</small>
            </div>
        </div>

        <!-- Khatmah Settings Modal (Overlay) -->
        <div id="khatmahModal" class="khatmah-modal" style="display: none;">
            <div class="khatmah-modal-content">
                <h3>حدد مدة الختمة</h3>
                <div class="khatmah-options">
                    <button class="khatmah-opt" data-days="7">7 أيام (أسبوعية)</button>
                    <button class="khatmah-opt" data-days="15">15 يوماً</button>
                    <button class="khatmah-opt" data-days="30">30 يوماً (شهرية)</button>
                    <button class="khatmah-opt" data-days="60">60 يوماً</button>
                </div>
                <div class="custom-khatmah">
                    <input type="number" id="customDaysInput" placeholder="أيام مخصصة..." min="1" max="1000">
                    <button id="setCustomKhatmahBtn">تأكيد</button>
                </div>
                <button id="closeKhatmahModal" class="close-modal-btn">إغلاق</button>
            </div>
        </div>

        <!-- Reading Settings Bar -->
        <div class="reading-settings-bar">
            <div class="font-controls">
                <button id="decreaseFont" title="تصغير الخط"><i class="fas fa-minus"></i></button>
                <span id="fontSizeDisplay">100%</span>
                <button id="increaseFont" title="تكبير الخط"><i class="fas fa-plus"></i></button>
            </div>
            <div class="theme-controls">
                <button class="theme-opt default active" data-theme="default" title="الوضع الافتراضي"></button>
                <button class="theme-opt sepia" data-theme="sepia" title="وضع القراءة (سيبيا)"></button>
                <button class="theme-opt night" data-theme="night" title="الوضع الليلي"></button>
            </div>
        </div>

        <div class="reading-container">
            <div id="readingContent" class="reading-content-area">
                <!-- Quran text will be rendered here -->
            </div>
        </div>
        <div class="reading-footer">
            <button id="prevSurahReading" class="nav-reading-btn"><i class="fas fa-chevron-right"></i> السورة
                السابقة</button>
            <button id="nextSurahReading" class="nav-reading-btn">السورة التالية <i
                    class="fas fa-chevron-left"></i></button>
        </div>
    </div>

    <!-- Sync Mode Page -->
    <div id="syncPage" class="page">
        <header>
            <button id="backFromSyncBtn" class="back-btn"><i class="fas fa-arrow-right"></i> إلغاء</button>
            <h1>أداة مزامنة الآيات</h1>
        </header>

        <div class="sync-container">
            <div class="sync-header-info">
                <h2 id="syncSurahTitle">اسم السورة</h2>
                <div class="sync-status">
                    الآية الحالية: <span id="syncCurrentVerseNum">1</span> / <span id="syncTotalVerses">0</span>
                </div>
            </div>

            <div class="sync-controls">
                <button id="markVerseBtn" class="sync-mark-btn">
                    <i class="fas fa-stopwatch"></i>
                    <span>اضغط عند بداية الآية</span>
                    <small>(أو اضغط Space)</small>
                </button>
                <div class="sync-playback-tools">
                    <button id="syncPlayPauseBtn" class="sync-tool-btn" title="تشغيل/إيقاف مؤقت">
                        <i class="fas fa-pause"></i>
                    </button>
                    <button id="syncSeekBackBtn" class="sync-tool-btn" title="رجوع 5 ثواني">
                        <i class="fas fa-backward"></i>
                    </button>
                </div>
            </div>


            <div class="sync-preview">
                <div class="sync-box current">
                    <small>الآية الحالية (اضغط عند سماعها):</small>
                    <div id="syncVerseText" class="sync-verse-text">...</div>
                </div>
                <div class="sync-box next">
                    <small>الآية القادمة (استعد):</small>
                    <div id="syncNextVerseText" class="sync-next-verse-text">...</div>
                </div>
            </div>

            <div class="sync-actions-extra">
                <button id="syncStepBackBtn" class="sync-secondary-btn">
                    <i class="fas fa-undo"></i> تراجع عن الخطوة الأخيرة
                </button>
            </div>


            <div id="syncResultArea" style="display: none;">
                <h3>تم الانتهاء! انسخ البيانات الجديدة:</h3>
                <textarea id="syncOutputJson" readonly class="sync-output"></textarea>
                <button id="copySyncResult" class="settings-btn">نسخ الكود</button>
            </div>

            <div class="sync-instructions">
                <ul>
                    <li>شغل السورة واستمع بدقة.</li>
                    <li>بمجرد نطق القارئ لبداية الآية الظاهرة، اضغط على الزر الكبير.</li>
                    <li>سينتقل التطبيق تلقائياً للآية التالية.</li>
                </ul>
            </div>
        </div>
    </div>

    <audio id="audioPlayer"></audio>

    <script src="data.js"></script>
    <script src="script.js"></script>
</body>

</html>